<apex:page standardController="Opportunity" extensions="OpportunityController">
  <apex:form >
    <apex:variable var="totalSoftCosts" value="{!IF(opp.Soft_Costs__c == 'Low', 1500, IF(opp.Soft_Costs__c == 'Medium', 3000, IF(opp.Soft_Costs__c == 'High', 5000, 0)))}" />
    <apex:variable var="totalDemoCosts" value="{!IF(opp.Demo__c == 'Low', ROUND(opp.Sqft__c * 2.0,0), IF(opp.Demo__c == 'Medium', ROUND(opp.Sqft__c * 3.0,0), IF(opp.Demo__c == 'High', ROUND(opp.Sqft__c * 4.0,0), 0)))}" />
    <apex:variable var="totalFoundationCosts" value="{!IF(opp.Foundation__c == 'Low', ROUND(opp.Sqft__c * 1.5,0), IF(opp.Foundation__c == 'Medium', ROUND(opp.Sqft__c * 4.5,0), IF(opp.Foundation__c == 'High', ROUND(opp.Sqft__c * 15.0,0), 0)))}" />
    <apex:variable var="totalRoofCosts" value="{!IF(opp.Roof__c == 'Low', 1000, IF(opp.Roof__c == 'Medium', 8000, IF(opp.Roof__c == 'High', 15000, 0)))}" />
    <apex:variable var="totalGutterCosts" value="{!IF(opp.Gutters__c == 'Low', 500, IF(opp.Gutters__c == 'Medium', 1500, IF(opp.Gutters__c == 'High', 3000, 0)))}" />
    <apex:variable var="totalHVACandWaterHeaterCosts" value="{!IF(opp.HVAC_and_Water_Heater__c  == 'Low', 2000, IF(opp.HVAC_and_Water_Heater__c  == 'Medium', 3500, IF(opp.HVAC_and_Water_Heater__c  == 'High', 8000, 0)))}" />
    <apex:variable var="totalWindowCosts" value="{!IF(opp.Windows__c  == 'Low', 400 * opp.of_Windows_num__c, IF(opp.Windows__c  == 'Medium',  800 * opp.of_Windows_num__c, IF(opp.Windows__c  == 'High',  1200 * opp.of_Windows_num__c, 0)))}" />
    <apex:variable var="totalInsulationCosts" value="{!IF(opp.Insulation__c == 'Low', ROUND(opp.Sqft__c * 1.0,0), IF(opp.Insulation__c == 'Medium', ROUND(opp.Sqft__c * 3.0,0), IF(opp.Insulation__c == 'High', ROUND(opp.Sqft__c * 5.0,0), 0)))}" />
    <apex:variable var="totalSidingCosts" value="{!IF(opp.Siding__c == 'Low', ROUND(opp.Sqft__c * 0.8,0), IF(opp.Siding__c == 'Medium', ROUND(opp.Sqft__c * 3.0,0), IF(opp.Siding__c == 'High', ROUND(opp.Sqft__c * 6.0,0), 0)))}" />
    <apex:variable var="totalConcreteCosts" value="{!IF(opp.Concrete__c == 'Low', 1500, IF(opp.Concrete__c == 'Medium', 4000, IF(opp.Concrete__c == 'High', 10000, 0)))}" />
    <apex:variable var="totalElectricalCosts" value="{!IF(opp.Electrical__c == 'Low', ROUND(opp.Sqft__c * 2.0,0), IF(opp.Electrical__c == 'Medium', ROUND(opp.Sqft__c * 4.0,0), IF(opp.Electrical__c == 'High', ROUND(opp.Sqft__c * 9.0,0), 0)))}" />
    <apex:variable var="totalPlumbingCosts" value="{!IF(opp.Plumbing__c == 'Low', ROUND(opp.Sqft__c * 1.25,0), IF(opp.Plumbing__c == 'Medium', ROUND(opp.Sqft__c * 2.5,0), IF(opp.Plumbing__c == 'High', ROUND(opp.Sqft__c * 4.5,0), 0)))}" />
    <apex:variable var="totalFramingCosts" value="{!IF(opp.Framing__c == 'Low', ROUND(opp.Sqft__c * 2.5,0), IF(opp.Framing__c == 'Medium', ROUND(opp.Sqft__c * 5.0,0), IF(opp.Framing__c == 'High', ROUND(opp.Sqft__c * 10.0,0), 0)))}" />
    <apex:variable var="totalSheetrockCosts" value="{!IF(opp.Sheetrock__c == 'Low', ROUND(opp.Sqft__c * 1.5,0), IF(opp.Sheetrock__c == 'Medium', ROUND(opp.Sqft__c * 3.0,0), IF(opp.Sheetrock__c == 'High', ROUND(opp.Sqft__c * 6.0,0), 0)))}" />
    <apex:variable var="totalFlooringCosts" value="{!IF(opp.Flooring__c == 'Low', ROUND(opp.Sqft__c * 3.0,0), IF(opp.Flooring__c == 'Medium', ROUND(opp.Sqft__c * 9.0,0), IF(opp.Flooring__c == 'High', ROUND(opp.Sqft__c * 15.0,0), 0)))}" />
    <apex:variable var="totalBathCosts" value="{!IF(opp.Baths__c == 'Low', 2500 * VALUE(opp.Bath__c), IF(opp.Baths__c == 'Medium', 5000 * VALUE(opp.Bath__c), IF(opp.Baths__c == 'High', 10000 * VALUE(opp.Bath__c), 0)))}" />
    <apex:variable var="totalGarageCosts" value="{!IF(opp.Garage_Doors__c == 'Low', 800 * opp.Garage__c, IF(opp.Garage_Doors__c == 'Medium', 1200 * opp.Garage__c, IF(opp.Garage_Doors__c == 'High', 2000 * opp.Garage__c, 0)))}" />
    <apex:variable var="totalKitchenCosts" value="{!IF(opp.Kitchen__c == 'Low', 7000, IF(opp.Kitchen__c == 'Medium', 15000, IF(opp.Kitchen__c == 'High', 25000, 0)))}" />
    <apex:variable var="totalInteriorPaint" value="{!IF(opp.Interior_Paint__c == 'Low', ROUND(opp.Sqft__c * 2.0,0), IF(opp.Interior_Paint__c == 'Medium', ROUND(opp.Sqft__c * 3.5,0), IF(opp.Interior_Paint__c == 'High', ROUND(opp.Sqft__c * 4.5,0), 0)))}" />
    <apex:variable var="totalExteriorPaint" value="{!IF(opp.Exterior_Paint__c == 'Low', ROUND(opp.Sqft__c * 1.75,0), IF(opp.Exterior_Paint__c == 'Medium', ROUND(opp.Sqft__c * 3.0,0), IF(opp.Exterior_Paint__c == 'High', ROUND(opp.Sqft__c * 4.0,0), 0)))}" />
    <apex:variable var="totalInteriorDoorCosts" value="{!IF(opp.Interior_Doors__c  == 'Low', 200 * opp.of_Interior_Doors_num__c, IF(opp.Interior_Doors__c  == 'Medium', 250 * opp.of_Interior_Doors_num__c, IF(opp.Interior_Doors__c  == 'High', 350 * opp.of_Interior_Doors_num__c, 0)))}" />
    <apex:variable var="totalExteriorDoorCosts" value="{!IF(opp.Exterior_Doors__c  == 'Low', 800 * opp.of_Exterior_Doors_num__c, IF(opp.Exterior_Doors__c  == 'Medium', 1200 * opp.of_Exterior_Doors_num__c, IF(opp.Exterior_Doors__c  == 'High', 3500 * opp.of_Exterior_Doors_num__c, 0)))}" />
    <apex:variable var="totalLandscapingCosts" value="{!IF(opp.Landscape__c == 'Low', 2000, IF(opp.Landscape__c == 'Medium', 5000, IF(opp.Landscape__c == 'High', 10000, 0)))}" />
    <apex:variable var="totalMiscellaneousCosts" value="{!IF(opp.Miscellaneous__c == 'Low', 5000, IF(opp.Miscellaneous__c == '8000', 3000, IF(opp.Miscellaneous__c == 'High', 10000, 0)))}" /> 
    <apex:variable var="totalRepairsCost" value="{!totalSoftCosts + totalDemoCosts + totalFoundationCosts + totalRoofCosts + totalGutterCosts + totalHVACandWaterHeaterCosts + totalWindowCosts + totalInsulationCosts + totalSidingCosts + totalConcreteCosts + totalElectricalCosts + totalPlumbingCosts + totalFramingCosts + totalSheetrockCosts + totalFlooringCosts + totalKitchenCosts + totalBathCosts + totalInteriorPaint + totalExteriorPaint + totalInteriorDoorCosts + totalExteriorDoorCosts + totalLandscapingCosts + totalMiscellaneousCosts}" />
    <apex:pageBlock >
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <th colspan="3">Line Item</th>
        </tr>
        <tr>
          <apex:column headerValue="Line Item" styleClass="item" width="75">
            <apex:outputLabel value="Soft Costs:" />
          </apex:column>
          <apex:column headerValue="Level of Work" styleClass="level" width="75">
            <apex:inputField value="{!opp.Soft_Costs__c}">
                <apex:actionSupport event="onchange" rerender="theSoftCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column headerValue="# of Units" styleClass="units" width="75">
            <apex:outputLabel value="" />
          </apex:column>
          <apex:column headerValue="Cost" styleClass="cost" width="75">
            <apex:outputPanel id="theSoftCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Soft_Costs__c != 'None' && opp.Soft_Costs__c != ''}">
                 <apex:param value="{!IF(opp.Soft_Costs__c == 'Low', 1500, IF(opp.Soft_Costs__c == 'Medium', 3000, IF(opp.Soft_Costs__c == 'High', 5000, 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Soft_Costs__c == 'None' || opp.Soft_Costs__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>

      
       <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Demo:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Demo__c}">
                <apex:actionSupport event="onchange" rerender="theDemoCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theDemoCosts">
               <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Demo__c != 'None' && opp.Demo__c != ''}">
                  <apex:param value="{!IF(opp.Demo__c == 'Low', ROUND(Opportunity.Sqft__c * 2.0,0), IF(opp.Demo__c == 'Medium', ROUND(Opportunity.Sqft__c * 3.0,0), IF(opp.Demo__c == 'High', ROUND(Opportunity.Sqft__c * 4.0,0), 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Demo__c == 'None' || opp.Demo__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
            <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Foundation:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Foundation__c}">
                <apex:actionSupport event="onchange" rerender="theFoundationCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theFoundationCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Foundation__c != 'None' && opp.Foundation__c != ''}">
                  <apex:param value="{!IF(opp.Foundation__c == 'Low', ROUND(opp.Sqft__c * 1.5,0), IF(opp.Foundation__c == 'Medium', ROUND(opp.Sqft__c * 4.5,0), IF(opp.Foundation__c == 'High', ROUND(opp.Sqft__c * 15.0,0), 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Foundation__c == 'None' || opp.Foundation__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Roof:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Roof__c}">
                <apex:actionSupport event="onchange" rerender="theRoofCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theRoofCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Roof__c != 'None' && opp.Roof__c != ''}">
                <apex:param value="{!IF(opp.Roof__c == 'Low', 1000, IF(opp.Roof__c == 'Medium', 8000, IF(opp.Roof__c == 'High', 15000, 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Roof__c == 'None' || opp.Roof__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Gutters:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Gutters__c}">
                <apex:actionSupport event="onchange" rerender="theGutterCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theGutterCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Gutters__c != 'None' && opp.Gutters__c != ''}">
                <apex:param value="{!IF(opp.Gutters__c == 'Low', 500, IF(opp.Gutters__c == 'Medium', 1500, IF(opp.Gutters__c == 'High', 3000, 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Gutters__c == 'None' || opp.Gutters__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="HVAC and Water Heater:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.HVAC_and_Water_Heater__c}">
                <apex:actionSupport event="onchange" rerender="theHVACandWaterHeaterCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
          <apex:outputPanel id="theHVACandWaterHeaterCosts">
            <apex:outputText value="${0,number,#,##0}" rendered="{!opp.HVAC_and_Water_Heater__c != 'None' && opp.HVAC_and_Water_Heater__c != ''}">
                <apex:param value="{!IF(opp.HVAC_and_Water_Heater__c  == 'Low', 2000, IF(opp.HVAC_and_Water_Heater__c  == 'Medium', 3500, IF(opp.HVAC_and_Water_Heater__c  == 'High', 8000, 0)))}" />
              </apex:outputText>
              <apex:outputText value="" rendered="{!opp.HVAC_and_Water_Heater__c == 'None' || opp.HVAC_and_Water_Heater__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Windows:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Windows__c}">
                <apex:actionSupport event="onchange" rerender="theWindowCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
              <apex:inputText value="{!Opportunity.of_Windows_num__c}" size="3">
                <apex:actionSupport event="onchange" rerender="theWindowCosts, totalTable" />
              </apex:inputText>
          </apex:column>
          <apex:column styleClass="cost" width="75">
              <apex:variable var="windowCost" value="{!totalWindowCosts}" />
              <apex:outputPanel id="theWindowCosts">
                <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Windows__c != 'None' && windowCost != 0}" >
                  <apex:param value="{!windowCost}" />
                </apex:outputText>
                <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Windows__c == 'None'}">
                  <apex:param value="{!0}" />
                </apex:outputText>
              </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>

      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Insulation:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Insulation__c}">
                <apex:actionSupport event="onchange" rerender="theInsulationCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theInsulationCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Insulation__c != 'None' && opp.Insulation__c != ''}">
                <apex:param value="{!IF(opp.Insulation__c == 'Low', ROUND(opp.Sqft__c * 1.0,0), IF(opp.Insulation__c == 'Medium', ROUND(opp.Sqft__c * 3.0,0), IF(opp.Insulation__c == 'High', ROUND(opp.Sqft__c * 5.0,0), 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Insulation__c == 'None' || opp.Insulation__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Siding:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Siding__c}">
                <apex:actionSupport event="onchange" rerender="theSidingCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theSidingCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Siding__c != 'None' && opp.Siding__c != ''}">
                <apex:param value="{!IF(opp.Siding__c == 'Low', ROUND(opp.Sqft__c * 0.8,0), IF(opp.Siding__c == 'Medium', ROUND(opp.Sqft__c * 3.0,0), IF(opp.Siding__c == 'High', ROUND(opp.Sqft__c * 6.0,0), 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Siding__c == 'None' || opp.Siding__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Concrete:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Concrete__c}">
                <apex:actionSupport event="onchange" rerender="theConcreteCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theConcreteCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Concrete__c != 'None' && opp.Concrete__c != ''}">
                <apex:param value="{!IF(opp.Concrete__c == 'Low', 1500, IF(opp.Concrete__c == 'Medium', 4000, IF(opp.Concrete__c == 'High', 10000, 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Concrete__c == 'None' || opp.Concrete__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Electrical:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Electrical__c}">
                <apex:actionSupport event="onchange" rerender="theElectricalCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theElectricalCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Electrical__c != 'None' && opp.Electrical__c != ''}">
                <apex:param value="{!IF(opp.Electrical__c == 'Low', ROUND(opp.Sqft__c * 2.0,0), IF(opp.Electrical__c == 'Medium', ROUND(opp.Sqft__c * 4.0,0), IF(opp.Electrical__c == 'High', ROUND(opp.Sqft__c * 9.0,0), 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Electrical__c == 'None' || opp.Electrical__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Plumbing:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Plumbing__c}">
                <apex:actionSupport event="onchange" rerender="thePlumbingCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="thePlumbingCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Plumbing__c != 'None' && opp.Plumbing__c != ''}">
                <apex:param value="{!IF(opp.Plumbing__c == 'Low', ROUND(opp.Sqft__c * 1.25,0), IF(opp.Plumbing__c == 'Medium', ROUND(opp.Sqft__c * 2.5,0), IF(opp.Plumbing__c == 'High', ROUND(opp.Sqft__c * 4.5,0), 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Plumbing__c == 'None' || opp.Plumbing__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Framing:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Framing__c}">
                <apex:actionSupport event="onchange" rerender="theFramingCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theFramingCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Framing__c != 'None' && opp.Framing__c != ''}">
                <apex:param value="{!IF(opp.Framing__c == 'Low', ROUND(opp.Sqft__c * 2.5,0), IF(opp.Framing__c == 'Medium', ROUND(opp.Sqft__c * 5.0,0), IF(opp.Framing__c == 'High', ROUND(opp.Sqft__c * 10.0,0), 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Framing__c == 'None' || opp.Framing__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Sheetrock:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Sheetrock__c}">
                <apex:actionSupport event="onchange" rerender="theSheetRockCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theSheetRockCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Sheetrock__c != 'None' && opp.Sheetrock__c != ''}">
                <apex:param value="{!IF(opp.Sheetrock__c == 'Low', ROUND(opp.Sqft__c * 1.5,0), IF(opp.Sheetrock__c == 'Medium', ROUND(opp.Sqft__c * 3.0,0), IF(opp.Sheetrock__c == 'High', ROUND(opp.Sqft__c * 6.0,0), 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Sheetrock__c == 'None' || opp.Sheetrock__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Flooring:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Flooring__c}">
                <apex:actionSupport event="onchange" rerender="theFlooringCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theFlooringCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Flooring__c != 'None' && opp.Flooring__c != ''}">
                <apex:param value="{!IF(opp.Flooring__c == 'Low', ROUND(opp.Sqft__c * 3.0,0), IF(opp.Flooring__c == 'Medium', ROUND(opp.Sqft__c * 9.0,0), IF(opp.Flooring__c == 'High', ROUND(opp.Sqft__c * 15.0,0), 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Flooring__c == 'None' || opp.Flooring__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Kitchen:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Kitchen__c}">
                <apex:actionSupport event="onchange" rerender="theKitchenCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theKitchenCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Kitchen__c != 'None' && opp.Kitchen__c != ''}">
                <apex:param value="{!IF(Opportunity.Kitchen__c == 'Low', 7000, IF(Opportunity.Kitchen__c == 'Medium', 15000, IF(Opportunity.Kitchen__c == 'High', 25000, 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Kitchen__c == 'None' || opp.Kitchen__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Bath:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Baths__c}">
                <apex:actionSupport event="onchange" rerender="theBathCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theBathCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Baths__c != 'None' && opp.Baths__c != ''}">
                <apex:param value="{!IF(opp.Baths__c == 'Low', 2500 * VALUE(opp.Bath__c), IF(opp.Baths__c == 'Medium', 5000 * VALUE(opp.Bath__c), IF(opp.Baths__c == 'High', 10000 * VALUE(opp.Bath__c), 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Baths__c == 'None' || opp.Baths__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
      
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Interior Paint:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Interior_Paint__c}">
                <apex:actionSupport event="onchange" rerender="theInteriorPaintCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theInteriorPaintCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Interior_Paint__c != 'None' && opp.Interior_Paint__c != ''}">
                <apex:param value="{!IF(opp.Interior_Paint__c == 'Low', ROUND(opp.Sqft__c * 2.0,0), IF(opp.Interior_Paint__c == 'Medium', ROUND(opp.Sqft__c * 3.5,0), IF(opp.Interior_Paint__c == 'High', ROUND(opp.Sqft__c * 4.5,0), 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Interior_Paint__c == 'None' || opp.Interior_Paint__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Exterior Paint:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Exterior_Paint__c}">
                <apex:actionSupport event="onchange" rerender="theExteriorPaintCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theExteriorPaintCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Exterior_Paint__c != 'None' && opp.Exterior_Paint__c != ''}">
                <apex:param value="{!IF(opp.Exterior_Paint__c == 'Low', ROUND(opp.Sqft__c * 1.75,0), IF(opp.Exterior_Paint__c == 'Medium', ROUND(opp.Sqft__c * 3.0,0), IF(opp.Exterior_Paint__c == 'High', ROUND(opp.Sqft__c * 4.0,0), 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Exterior_Paint__c == 'None' || opp.Exterior_Paint__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
    <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
            <apex:column styleClass="item" width="75">
                <apex:outputLabel value="Interior Doors:" />
            </apex:column>
            <apex:column styleClass="level" width="75">
                <apex:inputField value="{!opp.Interior_Doors__c}">
                    <apex:actionSupport event="onchange" rerender="theInteriorDoorCosts, totalTable" />
                </apex:inputField>
            </apex:column>
            <apex:column styleClass="units" width="75">
                <apex:inputText value="{!Opportunity.of_Interior_Doors_num__c}" size="3">
                    <apex:actionSupport event="onchange" rerender="theInteriorDoorCosts, totalTable" />
                </apex:inputText>
            </apex:column>
            <apex:column styleClass="cost" width="75">
                <apex:variable var="interiorDoorCost" value="{!totalInteriorDoorCosts}" />
                <apex:outputPanel id="theInteriorDoorCosts">
                    <apex:outputText rendered="{!Opportunity.Interior_Doors__c != 'None' && interiorDoorCost != 0}" value="${0,number,#,##0}">
                        <apex:param value="{!interiorDoorCost}" />
                    </apex:outputText>
                </apex:outputPanel>
            </apex:column>
        </tr>
    </apex:pageBlockTable>

      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
            <apex:column styleClass="item" width="75">
                <apex:outputLabel value="Exterior Doors:" />
            </apex:column>
            <apex:column styleClass="level" width="75">
                <apex:inputField value="{!opp.Exterior_Doors__c}">
                <apex:actionSupport event="onchange" rerender="theExteriorDoorCosts, totalTable" />
            </apex:inputField>
            </apex:column>
            <apex:column styleClass="units" width="75">
                <apex:inputText value="{!Opportunity.of_Exterior_Doors_num__c}" size="3">
                    <apex:actionSupport event="onchange" rerender="theExteriorDoorCosts, totalTable" />
                </apex:inputText>
            </apex:column>
            <apex:column styleClass="cost" width="75">
                <apex:variable var="exteriorDoorCost" value="{! totalExteriorDoorCosts}" />
                <apex:outputPanel id="theExteriorDoorCosts">
                    <apex:outputText rendered="{!Opportunity.Exterior_Doors__c != 'None' && exteriorDoorCost != 0}" value="${0,number,#,##0}">
                        <apex:param value="{!exteriorDoorCost}" />
                    </apex:outputText>
                </apex:outputPanel>
            </apex:column>
        </tr>
    </apex:pageBlockTable>
      
      
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Garage Doors:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Garage_Doors__c}">
                <apex:actionSupport event="onchange" rerender="theGarageDoorCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theGarageDoorCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Garage_Doors__c != 'None' && opp.Garage_Doors__c != ''}">
                <apex:param value="{!IF(opp.Garage_Doors__c == 'Low', 800 * opp.Garage__c, IF(opp.Garage_Doors__c == 'Medium', 1200 * opp.Garage__c, IF(opp.Garage_Doors__c == 'High', 2000 * opp.Garage__c, 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Garage_Doors__c == 'None' || opp.Garage_Doors__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
            
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Landscaping:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Landscape__c}">
                <apex:actionSupport event="onchange" rerender="theLandscapingCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theLandscapingCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Landscape__c != 'None' && opp.Landscape__c != ''}">
                <apex:param value="{!IF(opp.Landscape__c == 'Low', 2000, IF(opp.Landscape__c == 'Medium', 5000, IF(opp.Landscape__c == 'High', 10000, 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Landscape__c == 'None' || opp.Landscape__c == ''}"/>
            </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
      <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2">
        <tr>
          <apex:column styleClass="item" width="75">
            <apex:outputLabel value="Miscellaneous:" />
          </apex:column>
          <apex:column styleClass="level" width="75">
            <apex:inputField value="{!opp.Miscellaneous__c}">
                <apex:actionSupport event="onchange" rerender="theMiscellaneousCosts, totalTable" />
            </apex:inputField>
          </apex:column>
          <apex:column styleClass="units" width="75">
          </apex:column>
          <apex:column styleClass="cost" width="75">
            <apex:outputPanel id="theMiscellaneousCosts">
              <apex:outputText value="${0,number,#,##0}" rendered="{!opp.Miscellaneous__c != 'None' && opp.Miscellaneous__c != ''}">
                <apex:param value="{!IF(opp.Miscellaneous__c == 'Low', 5000, IF(opp.Miscellaneous__c == '8000', 3000, IF(opp.Miscellaneous__c == 'High', 10000, 0)))}" />
              </apex:outputText>
             <apex:outputText value="" rendered="{!opp.Miscellaneous__c == 'None' || opp.Miscellaneous__c == ''}"/>
           </apex:outputPanel>
          </apex:column>
        </tr>
      </apex:pageBlockTable>
      
      
       <apex:pageBlockTable value="{!Opportunity}" var="opp" columnClasses="item, level, units, cost" rows="2" id="totalTable">
        <tr>
          <apex:column styleClass="item" width="75">
          </apex:column>
          <apex:column styleClass="level" width="75">
          </apex:column>
          <apex:column styleClass="units" width="75" style="text-align:right;">
            <b><apex:outputText value="Total:"/></b>
          </apex:column>
          <apex:column styleClass="cost" width="75">
              <apex:outputPanel id="theTotalCost">
               <apex:outputText value="${0,number,#,##0}" style="font-weight:bold">
                <apex:param value="{!totalRepairsCost}" />
               </apex:outputText>
              </apex:outputPanel>
         </apex:column>
       </tr>
     </apex:pageBlockTable>
       <div style="text-align:center; margin-top: 5px;">
         <apex:commandButton id="saveButton" value="Save" action="{!save}"/>
         <apex:commandButton action="{!cancel}" value="Cancel"/>
       </div>
      <apex:pageMessages />
    </apex:pageBlock>
  </apex:form>  
   
<script>
  function updateCost(input) {
    var row = input.closest('tr');
    var costColumn = row.querySelector('.cost .amount');
    var picklistValue = row.querySelector('.level select').value;
    var windowUnits = row.querySelector('.units input').value;
    if (picklistValue == 'None') {
      costColumn.innerHTML = '$0.00';
    } else if (picklistValue == 'Low') {
      costColumn.innerHTML = '$' + (windowUnits * 400).toLocaleString(undefined, {maximumFractionDigits: 2});
    } else if (picklistValue == 'Medium') {
      costColumn.innerHTML = '$' + (windowUnits * 800).toLocaleString(undefined, {maximumFractionDigits: 2});
    } else if (picklistValue == 'High') {
      costColumn.innerHTML = '$' + (windowUnits * 1200).toLocaleString(undefined, {maximumFractionDigits: 2});
    }
  }

  // Set the cost column to $0.00 when the picklist value is None on page load
  window.onload = function() {
    var picklists = document.querySelectorAll('.level select');
    picklists.forEach(function(picklist) {
      if (picklist.value == 'None') {
        var row = picklist.closest('tr');
        var costColumn = row.querySelector('.cost .amount');
        costColumn.innerHTML = '$0.00';
      }
    });
  };
</script>
<script>
    function updateCost(input) {
      var row = input.closest('tr');
      var costColumn = row.querySelector('.cost .amount');
      var picklistValue = row.querySelector('.level select').value;
      var interiorDoors = row.querySelector('.units input').value;
      if (picklistValue == 'None') {
        costColumn.innerHTML = '$0.00';
      } else if (picklistValue == 'Low') {
        costColumn.innerHTML = '$' + (interiorDoors * 200).toLocaleString(undefined, {maximumFractionDigits: 2});
      } else if (picklistValue == 'Medium') {
        costColumn.innerHTML = '$' + (interiorDoors * 250).toLocaleString(undefined, {maximumFractionDigits: 2});
      } else if (picklistValue == 'High') {
        costColumn.innerHTML = '$' + (interiorDoors * 350).toLocaleString(undefined, {maximumFractionDigits: 2});
      }
    }
</script>
<script>
    function updateCost(input) {
      var row = input.closest('tr');
      var costColumn = row.querySelector('.cost .amount');
      var picklistValue = row.querySelector('.level select').value;
      var exteriorDoors = row.querySelector('.units input').value;
      if (picklistValue == 'None') {
        costColumn.innerHTML = '$0.00';
      } else if (picklistValue == 'Low') {
        costColumn.innerHTML = '$' + (exteriorDoors * 800).toLocaleString(undefined, {maximumFractionDigits: 2});
      } else if (picklistValue == 'Medium') {
        costColumn.innerHTML = '$' + (exteriorDoors * 1200).toLocaleString(undefined, {maximumFractionDigits: 2});
      } else if (picklistValue == 'High') {
        costColumn.innerHTML = '$' + (exteriorDoors * 3500).toLocaleString(undefined, {maximumFractionDigits: 2});
      }
    }
</script>
</apex:page>
